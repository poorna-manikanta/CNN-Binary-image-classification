import numpy as np
from tensorflow.keras.models import load_model
from sklearn.metrics import classification_report, confusion_matrix
from data_loader import load_data
from config import MODEL_PATH

def evaluate():
    # Load model
    model = load_model(MODEL_PATH)

    # Load validation data
    _, val_data = load_data()

    # Predict
    val_data.reset()
    predictions = model.predict(val_data)
    y_pred = (predictions > 0.5).astype(int).ravel()
    y_true = val_data.classes

    # Metrics
    print("ðŸ“Š Classification Report:")
    print(classification_report(y_true, y_pred))

    print("ðŸ“‰ Confusion Matrix:")
    print(confusion_matrix(y_true, y_pred))

if __name__ == "__main__":
    evaluate()
